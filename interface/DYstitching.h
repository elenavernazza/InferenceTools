#ifndef DYstitching_h
#define DYstitching_h

// -------------------------------------------------------------------------------------------------------------- //
//                                                                                                                //
//   class DYstitching                                                                                          //
//                                                                                                                //
//                                                                                                                //
//   Author: Jaime Leon Holgado                                                                                   //
//   CIEMAT, January 2022                                                                                         //
//                                                                                                                //
// -------------------------------------------------------------------------------------------------------------- //

#include <vector>
#include <TLorentzVector.h>

// DYstitching class
class DYstitching {

  public:
    DYstitching (int year);
    
    ~DYstitching ();
    
    
    float get_stitching_weight(int LHE_Nb, int LHE_Njets, float LHE_HT);
  private:
  
    std::vector<std::vector<std::vector<float>>> stitchWeights;
    
    std::vector<std::vector<std::vector<float>>> stitchWeights_2016 = {
     {
      {2.0214652898 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.651052057245 , 0.413673961171 , 0.367765842648 , 0.180094896131 , 0.0343370323359 , 0.00954032131527 , 0.0131222173306 , 0.0301711237283 , 0.0},
      {0.529309657185 , 0.36056089643 , 0.325974171258 , 0.171534260884 , 0.032466795382 , 0.00945749305561 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.675950344672 , 0.32568221353 , 0.367040675149 , 0.183009066172 , 0.0302107942635 , 0.00813438859745 , 0.010611777963 , 0.0121964424085 , 0.000440030333986},
      {0.543306873307 , 0.270506289373 , 0.325796314916 , 0.171988010161 , 0.0332961566334 , 0.0095407955011 , 0.0130271573311 , 0.0120330765125 , 0.0},
      {0.180013628884 , 0.137599927721 , 0.146390493132 , 0.106846640414 , 0.0294570461364 , 0.00933979747754 , 0.0126186010222 , 0.0273170985108 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.687846534123 , 0.684357797036 , 0.368600440603 , 0.184644952054 , 0.0325122136015 , 0.00903182959861 , 0.0126509994188 , 0.0121787743827 , 0.000439986122197},
      {0.548446673425 , 0.55167674792 , 0.323846695197 , 0.17286177231 , 0.0310999917786 , 0.00954461685366 , 0.0131195412843 , 0.0122281273404 , 0.0},
      {0.178839898433 , 0.176730904692 , 0.143502984814 , 0.10389780536 , 0.0272513863363 , 0.00926873148301 , 0.0125267798314 , 0.0118359212397 , 0.000440227789824},
      {0.172146093067 , 0.158826579438 , 0.148762921015 , 0.0993078479982 , 0.0287760064141 , 0.0110900618719 , 0.0808586115919 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.565852537358 , 0.555308359906 , 0.332153310173 , 0.177960897092 , 0.0329882787666 , 0.00966903303917 , 0.0132228883753 , 0.0121844339873 , 0.000439991106937},
      {0.459317720411 , 0.473586356073 , 0.300262722228 , 0.16693007398 , 0.0322685431248 , 0.0101707397812 , 0.0139390193892 , 0.0120488117338 , 0.000440227789824},
      {0.166792535552 , 0.159897213879 , 0.134436541077 , 0.0974169614957 , 0.0275952936974 , 0.00917495710406 , 0.0124667137942 , 0.0115604601835 , 0.000439584558103},
      {0.120684494913 , 0.160067100927 , 0.127573323042 , 0.103097020825 , 0.0289775329435 , 0.00911453729911 , 0.0123809947417 , 0.0110458533678 , 0.0},
      {0.0 , 0.147420721388 , 0.121311850905 , 0.0852340906631 , 0.0285843898605 , 0.00897584049423 , 0.0125724757035 , 0.0 , 0.0}
     }
    };
    
    std::vector<std::vector<std::vector<float>>> stitchWeights_2017 = {
     {
      {2.67924942929 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.461117683668 , 0.288238720368 , 0.244019240573 , 0.135712598664 , 0.0269283578771 , 0.00941836691982 , 0.0114129617531 , 0.011988459216 , 0.0},
      {0.461212654939 , 0.290136436976 , 0.244986053293 , 0.136124152655 , 0.0279796670743 , 0.00930161903327 , 0.0110697147831 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.949886615633 , 0.427077416714 , 0.337222105969 , 0.163365897405 , 0.0274860094365 , 0.0085763948538 , 0.00984568261813 , 0.0127266252667 , 0.000332160869},
      {0.951726921973 , 0.426627652639 , 0.337677509383 , 0.165532173003 , 0.0276083457065 , 0.00946915409563 , 0.0115775376776 , 0.0128101172201 , 0.00033226404057},
      {0.121324851414 , 0.106045639829 , 0.100815528572 , 0.0780316234378 , 0.0247725227854 , 0.00901472262325 , 0.0110643844762 , 0.0124032384969 , 0.00033226404057},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.577067228092 , 0.339488860229 , 0.281949193594 , 0.150675590712 , 0.0284045541296 , 0.00901824980452 , 0.0109304611343 , 0.0123845395413 , 0.000332089281822},
      {0.556659233845 , 0.340642946262 , 0.280794949338 , 0.151779081379 , 0.0299185936652 , 0.00939894134359 , 0.0115118981289 , 0.0125472761053 , 0.00033226404057},
      {0.110789928447 , 0.0988388485028 , 0.0928127275372 , 0.0725867160614 , 0.0232600189656 , 0.00885064768037 , 0.0106222671228 , 0.0115267375239 , 0.00033226404057},
      {0.112408736859 , 0.0931192442339 , 0.0896787822135 , 0.0622383718531 , 0.0222605939937 , 0.00885290573742 , 0.0107109740262 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.265905408184 , 0.318351907391 , 0.277460603301 , 0.14951447431 , 0.0286698923867 , 0.00952507054503 , 0.0115701542716 , 0.0125887043617 , 0.000332055200272},
      {0.676589412083 , 0.319984941653 , 0.27316522003 , 0.146338413189 , 0.0288698984769 , 0.00939038668954 , 0.0109420127173 , 0.0125827030236 , 0.000332070131004},
      {0.139908908454 , 0.0900754237066 , 0.0886977006279 , 0.0706148949084 , 0.0237342746423 , 0.00840780447228 , 0.0108117809972 , 0.0115681226813 , 0.000331184452335},
      {0.109026527077 , 0.0983207166623 , 0.0923879113549 , 0.0763313187779 , 0.0238773034326 , 0.0088172397373 , 0.0103986787623 , 0.0114508669773 , 0.00033226404057},
      {0.081627606458 , 0.103082430047 , 0.0890246573134 , 0.0766960714492 , 0.0240498812676 , 0.00865341559255 , 0.0103416300943 , 0.0104291494869 , 0.00033226404057}
     }
    };

  
    std::vector<std::vector<std::vector<float>>> stitchWeights_2018 = {
     {
      {2.67333612809 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.51898547586 , 0.307918393636 , 0.299712383744 , 0.152457027204 , 0.017727351316 , 0.00960959105875 , 0.0118479734376 , 0.0153247097079 , 0.0},
      {0.521376206466 , 0.308647458404 , 0.305485779629 , 0.152859451028 , 0.0176935784475 , 0.0096261248727 , 0.0121070399122 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.580157109833 , 0.323048584481 , 0.316235063773 , 0.155031902758 , 0.0166252750008 , 0.00929109993408 , 0.0119071053391 , 0.0155571504236 , 0.000294085695839},
      {0.576159635871 , 0.32225013185 , 0.317509585462 , 0.156832157172 , 0.0176872450509 , 0.00959797340356 , 0.0119359304201 , 0.0116739568912 , 0.000294219655312},
      {0.114285902101 , 0.0983303196122 , 0.0960268363933 , 0.0716322046668 , 0.0160449241071 , 0.00911109415307 , 0.0113069937242 , 0.0141381182245 , 0.000294219655312},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.682278722716 , 0.362765385278 , 0.352621143228 , 0.165382670894 , 0.0174462106614 , 0.00958560178972 , 0.0113611990133 , 0.0155822731809 , 0.00029419199659},
      {0.658904274958 , 0.355925643213 , 0.346908775498 , 0.160894989801 , 0.0172806075072 , 0.00961908326477 , 0.0118871488334 , 0.015698805782 , 0.000294219655312},
      {0.116329810304 , 0.103266407792 , 0.101348794702 , 0.0755949912983 , 0.0146934201983 , 0.00901755115964 , 0.0110541461103 , 0.0145892891019 , 0.000294219655312},
      {0.11037555227 , 0.0943817218953 , 0.0935595693025 , 0.0707927004997 , 0.0158861665046 , 0.00910876641137 , 0.0109700992432 , 0.0 , 0.0},
      {0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0}
     },
     {
      {0.39949438878 , 0.374723947015 , 0.376569839917 , 0.172402895473 , 0.0180531001354 , 0.00967811533818 , 0.0120470434947 , 0.0155848428971 , 0.000294072214121},
      {0.414012232227 , 0.373314693384 , 0.376696425396 , 0.171730043145 , 0.0186814560654 , 0.0095357673104 , 0.0119075584174 , 0.015490698255 , 0.000293965944772},
      {0.116854871611 , 0.0868542494347 , 0.0907644237315 , 0.0698678272198 , 0.0146930461579 , 0.00814494915235 , 0.011051375833 , 0.014209820022 , 0.000293717221136},
      {0.116039136671 , 0.0967397955117 , 0.0961209059992 , 0.0706452766584 , 0.0156626168091 , 0.00902743165164 , 0.0108147123949 , 0.014651354602 , 0.000294219655312},
      {0.0 , 0.0928514258164 , 0.0892665638494 , 0.0675120069126 , 0.0156701331724 , 0.00894531805894 , 0.0111842302729 , 0.01400886702 , 0.0}
     }
    };
};

#endif // DYstitching_h